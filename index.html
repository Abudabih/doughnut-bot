<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doughnut Automation</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');
        :root {
            --bg: #0f0f0f; --card: #1a1a1a; --accent: #ff70a6; 
            --text: #ffffff; --dim: #888; --input: #252525;
        }
        body {
            font-family: 'Poppins', sans-serif; background: var(--bg);
            color: var(--text); display: flex; justify-content: center;
            align-items: center; min-height: 100vh; margin: 0;
        }
        .container {
            background: var(--card); padding: 25px; border-radius: 24px;
            width: 100%; max-width: 400px; border: 1px solid #333;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }
        .logo svg { width: 50px; fill: var(--accent); margin-bottom: 10px; }
        h1 { font-size: 1.4rem; margin: 0 0 20px; letter-spacing: 1px; color: var(--accent); }
        label { display: block; text-align: left; font-size: 0.8rem; color: var(--dim); margin-bottom: 5px; }
        input, textarea {
            width: 100%; background: var(--input); border: 1px solid #333;
            border-radius: 12px; padding: 12px; color: #fff; margin-bottom: 15px;
            box-sizing: border-box; font-family: inherit;
        }
        textarea { height: 80px; resize: none; font-size: 0.75rem; }
        button {
            width: 100%; padding: 14px; background: var(--accent);
            border: none; border-radius: 12px; color: #fff; font-weight: 600;
            cursor: pointer; transition: 0.3s;
        }
        button:hover { opacity: 0.8; transform: translateY(-2px); }
        button:disabled { background: #444; cursor: not-allowed; }
        
        .logs {
            background: #000; border-radius: 12px; padding: 15px;
            margin: 20px 0; height: 120px; overflow-y: auto;
            font-family: monospace; font-size: 0.75rem; text-align: left; border: 1px solid #222;
        }
        .log-success { color: #00ff88; } .log-error { color: #ff4444; }

        /* Stats Row */
        .stats-row { display: flex; gap: 10px; margin-top: 10px; }
        .stat-card {
            flex: 1; background: var(--input); padding: 12px; border-radius: 15px;
            display: flex; align-items: center; border: 1px solid #333;
        }
        .stat-card svg { width: 20px; fill: var(--accent); margin-right: 10px; }
        .stat-text { text-align: left; }
        .stat-text span { display: block; line-height: 1.2; }
        .stat-label { font-size: 0.65rem; color: var(--dim); font-weight: 600; text-transform: uppercase; }
        .stat-val { font-size: 0.9rem; font-weight: 600; }
    </style>
</head>
<body>

<div class="container">
    <div class="logo">
        <svg viewBox="0 0 24 24"><path d="M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7H14A7,7 0 0,1 21,14H22A1,1 0 0,1 23,15V18A1,1 0 0,1 22,19H21V20A2,2 0 0,1 19,22H5A2,2 0 0,1 3,20V19H2A1,1 0 0,1 1,18V15A1,1 0 0,1 2,14H3A7,7 0 0,1 10,7H11V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2M7.5,13A2.5,2.5 0 0,0 5,15.5A2.5,2.5 0 0,0 7.5,18A2.5,2.5 0 0,0 10,15.5A2.5,2.5 0 0,0 7.5,13M16.5,13A2.5,2.5 0 0,0 14,15.5A2.5,2.5 0 0,0 16.5,18A2.5,2.5 0 0,0 19,15.5A2.5,2.5 0 0,0 16.5,13Z" /></svg>
    </div>
    <h1>Doughnut Automation</h1>

    <form id="botForm">
        <label>Cookies (JSON format)</label>
        <textarea id="cookies" required placeholder='Paste your JSON cookies here...'></textarea>
        
        <label>Prefix</label>
        <input type="text" id="prefix" value="!">
        
        <label>Admin UID (Optional)</label>
        <input type="text" id="adminID" placeholder="615xxxxxxxxxxx">
        
        <button type="submit" id="btn">Automate Account</button>
    </form>

    <div class="logs" id="logBox">> System ready...</div>

    <div class="stats-row">
        <div class="stat-card">
            <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
            <div class="stat-text">
                <span class="stat-label">Active</span>
                <span class="stat-val" id="activeCount">0</span>
            </div>
        </div>
        <div class="stat-card">
            <svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-5 14H5v-2h10v2zm4-4H5V9h14v5z"/></svg>
            <div class="stat-text">
                <span class="stat-label">Commands</span>
                <span class="stat-val" id="cmdCount">0</span>
            </div>
        </div>
    </div>
</div>

<script>
    const delay = ms => new Promise(res => setTimeout(res, ms));
    const logBox = document.getElementById('logBox');

    function addLog(txt, cls = '') {
        const div = document.createElement('div');
        div.className = cls;
        div.textContent = `> ${txt}`;
        logBox.appendChild(div);
        logBox.scrollTop = logBox.scrollHeight;
    }

    async function getStats() {
        try {
            const res = await fetch('/stats');
            const data = await res.json();
            document.getElementById('activeCount').textContent = data.activeUsers;
            document.getElementById('cmdCount').textContent = data.totalCommands;
        } catch(e) {}
    }

    setInterval(getStats, 5000);
    getStats();

    document.getElementById('botForm').onsubmit = async (e) => {
        e.preventDefault();
        const btn = document.getElementById('btn');
        btn.disabled = true;

        addLog("Automating...");
        await delay(3000);
        addLog("Logging in...");
        await delay(3000);

        try {
            const res = await fetch('/login', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    appState: document.getElementById('cookies').value,
                    prefix: document.getElementById('prefix').value,
                    adminID: document.getElementById('adminID').value
                })
            });
            const data = await res.json();
            if(data.success) {
                addLog("Logged in!", "log-success");
                addLog(`Hello, ${data.name} (${data.id})`, "log-success");
                getStats();
            } else {
                addLog(`Error: ${data.message}`, "log-error");
                btn.disabled = false;
            }
        } catch(e) {
            addLog("Server error.", "log-error");
            btn.disabled = false;
        }
    };
</script>
</body>
</html>
